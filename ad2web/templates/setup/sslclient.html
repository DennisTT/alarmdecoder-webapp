{% from "macros/_form.html" import render_form %}

{% extends 'setup/layout.html' %}

{% block css %}
{% endblock %}

{% block pagejs %}
<script type="text/javascript">
</script>
{% endblock %}

{% block body %}
<div id="setup" class="container">
	<h3>SSL Client Settings</h3>
	<div>
		<p>
		Since you'd like to connect to your networked AlarmDecoder via an encrypted ser2sock stream we need to import the certificates and keys necessary to communicate with the server.  
		</p>

		<p>
		At this point <a href="http://github.com/nutechsoftware/ser2sock">ser2sock</a> is the only supported server software and we're assuming that ser2sock was configured manually and the certificates were generated by hand.
		</p>
        <p>
            <h4>Generating the Server Certificates</h4>
            <ul style="list-style-type: none">
                <li>Create the CA certificate and key: <strong>openssl req -out ca.pem -new -x509</strong></li>
                <li>Generate the Server Key: <strong>openssl genrsa -out server.key 2048</strong></li>
                <li>Generate a signing request for the Server: <strong>open ssl req -key server.key -new -out server.req</strong></li>
                <li>Sign the request: <strong>echo "00" > ca.srl && openssl x509 -req -in server.req -CA ca.pem -CAkey privkey.pem -CAserial ca.srl -out server.pem</strong></li>
            </ul>
            <h4>Generating the Client Key</h4>
            <ul style="list-style-type: none">
                <li>Generate the Client Key: <strong>openssl req -key client.key -new -out client.req</strong></li>
                <li>Generate signing request for Client: <strong>openssl req -key client.key -new -out client.req</strong></li>
                <li>Sign the client request: <strong>openssl x509 -req -in client.req -CA ca.pem -CAkey privkey.pem -CAserial ca.srl -out client.pem</strong></li>
            </ul>
            If you are using the AlarmDecoder WebApp to host your ser2sock encrypted, these certificates are generated automatically and can be found on that host.<br/>
            Once you have generated the server and client portions, you can populate your ser2sock configuration file with the server certificates, and import your client certificates here.
        </p>
	</div>
	<br>
    {{ render_form(url_for('setup.sslclient'), form) }}
</div>
{% endblock %}

{% block js_btm %}
{% endblock %}
